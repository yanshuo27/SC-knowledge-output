import subprocess

# 配置数据库连接信息
username = 'your_username'
password = 'your_password'
database = 'your_database'
hostname = 'your_hostname'
port = '1521'

# 构建SQL*Plus命令
sqlplus_cmd = f'sqlplus -s {username}/{password}@{hostname}:{port}/{database}'

# 要执行的SQL命令
sql_command = """
SELECT * FROM your_table;
EXIT;
"""

# 使用subprocess调用SQL*Plus并执行SQL命令
try:
    # 启动SQL*Plus进程
    proc = subprocess.Popen(sqlplus_cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)
    
    # 向SQL*Plus进程发送SQL命令
    stdout, stderr = proc.communicate(sql_command.encode('utf-8'))
    
    # 检查是否有错误输出
    if stderr:
        print("Error:", stderr.decode('utf-8'))
    else:
        # 打印SQL*Plus命令的输出结果
        print("Output:\n", stdout.decode('utf-8'))

except Exception as e:
    print("An error occurred:", e)
